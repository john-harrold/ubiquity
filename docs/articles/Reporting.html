<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Report Generation • ubiquity</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/united/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Report Generation">
<meta property="og:description" content="ubiquity">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">ubiquity</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.0.5</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fas fa-chalkboard-teacher"></span>
     
    Tutorials
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li class="divider">
    <li class="dropdown-header">Getting Started</li>
    <li>
      <a href="../articles/Simulation.html">Individual and Population Simulations</a>
    </li>
    <li>
      <a href="../articles/Language.html">ubiquity Modeling Language</a>
    </li>
    <li>
      <a href="../articles/Estimation.html">Naive-Pooled Parameter Estimation</a>
    </li>
    <li class="divider">
    <li class="dropdown-header">Other Analysis Options</li>
    <li>
      <a href="../articles/Deployment.html">Deploying Your Models in a Shiny App</a>
    </li>
    <li>
      <a href="../articles/Titration.html">Trial/Rule-Based Simulations</a>
    </li>
    <li>
      <a href="../articles/NCA.html">Non-Compartmental Analysis</a>
    </li>
    <li>
      <a href="../articles/Reporting.html">Integrated Word and PowerPoint Reporting</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fas fa-video"></span>
     
    Screencasts
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="https://vimeo.com/382859445">Individual and Population Simulations</a>
    </li>
    <li>
      <a href="https://vimeo.com/382860283">Model Deployment</a>
    </li>
    <li>
      <a href="https://vimeo.com/manage/videos/382829588">Naive-Pooled Parameter Estimation</a>
    </li>
  </ul>
</li>
<li>
  <a href="../reference/index.html">
    <span class="fas fa-hat-wizard"></span>
     
    Functions
  </a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/john-harrold/ubiquity/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="Reporting_files/header-attrs-2.8/header-attrs.js"></script><link href="Reporting_files/tabwid-1.0.0/tabwid.css" rel="stylesheet">
<script src="Reporting_files/tabwid-1.0.0/tabwid.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Report Generation</h1>
                        <h4 class="author">John Harrold &amp; Anson Abraham</h4>
            
            <h4 class="date">2021-07-17</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/john-harrold/ubiquity/blob/master/vignettes/Reporting.Rmd"><code>vignettes/Reporting.Rmd</code></a></small>
      <div class="hidden name"><code>Reporting.Rmd</code></div>

    </div>

    
    
<div id="introduction" class="section level2">
<h2 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h2>
<p>Reporting is implemented using the <code>officer</code> package. Officer provides a lot of control over the generation of both Word and PowerPoint documents. If you feel comfortable programming in R, you can simply use that package directly. Currently ubiquity has support for generating both PowerPoint and Word reports, and this vingette will go over example scripts for both types of reports. To make a copy of the example scripts in the current working directory run the following:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ubiquity.tools/rworkflow">ubiquity</a></span><span class="op">)</span>
<span class="va">fr</span> <span class="op">=</span> <span class="fu"><a href="../reference/workshop_fetch.html">workshop_fetch</a></span><span class="op">(</span>section<span class="op">=</span><span class="st">"Reporting"</span>, overwrite<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<p>This should create the following scripts</p>
<ul>
<li>
<code>make_report_PowerPoint.R</code> Generates a PowerPoint presentation from an R script</li>
<li>
<code>make_report_Word.R</code> Generates a Word document from an R script</li>
</ul>
<p>Then general process for creating a report is:</p>
<ol style="list-style-type: decimal">
<li>Initialize a report using the function <code>system_report_init</code>
</li>
<li>Use the functions that begin with <code>system_report_slide</code> to add content to the report</li>
<li>Lastly, save the output using <code>system_report_save</code>
</li>
</ol>
</div>
<div id="powerpoint-reports-make_report_powerpoint-r" class="section level2">
<h2 class="hasAnchor">
<a href="#powerpoint-reports-make_report_powerpoint-r" class="anchor"></a>PowerPoint reports (<code>make_report_PowerPoint.R</code>)</h2>
<p>Trying to keep track of different slide layouts, placeholder names, and indices can be cumbersome. The following functions have been created to allow slides to be created easily:</p>
<ul>
<li>
<code>system_report_init</code> - Initialize a new report from a template</li>
<li>
<code>system_report_view_layout</code> - Generate a PowerPoint file from a template labeling the different elements each slide layout</li>
<li>
<code>system_report_fetch</code> - Fetch the officer object for a report</li>
<li>
<code>system_report_set</code> - Set the officer object for a report</li>
<li>
<code>system_report_save</code> - Save a report to a file</li>
<li>
<code>system_report_slide_title</code> - Add a title slide</li>
<li>
<code>system_report_slide_section</code> - Add a slide separating sections in a presentation</li>
<li>
<code>system_report_slide_content</code> - Add a slide with a title, subtitle and a single area of content taking up the entire slide</li>
<li>
<code>system_report_slide_two_col</code> - Add a slide with a title, subtitle, and two columns of content with or without headings</li>
</ul>
<p>The first five of these functions are general reporting functions and those that begin with <code>system_report_slide</code> are used to add slides to a PowerPoint report. Examples of how to use these functions can be found in the file <code>make_report_PowerPoint.R</code>, and the text below is intended to document their use in more detail.</p>
<div id="creating-a-report" class="section level3">
<h3 class="hasAnchor">
<a href="#creating-a-report" class="anchor"></a>Creating a report</h3>
<p>The first step is to initialize a report:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/system_new.html">system_new</a></span><span class="op">(</span>file_name<span class="op">=</span><span class="st">"system.txt"</span>, system_file<span class="op">=</span><span class="st">"mab_pk"</span>, overwrite <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="va">cfg</span> <span class="op">=</span> <span class="fu"><a href="../reference/build_system.html">build_system</a></span><span class="op">(</span>system_file <span class="op">=</span> <span class="st">"system.txt"</span><span class="op">)</span>
<span class="va">cfg</span> <span class="op">=</span> <span class="fu"><a href="../reference/system_report_init.html">system_report_init</a></span><span class="op">(</span><span class="va">cfg</span>, rpttype<span class="op">=</span><span class="st">"PowerPoint"</span><span class="op">)</span></code></pre></div>
<p>This will create a report named <code>"default"</code>. To create multiple reports you can use the <code>rptname</code> input and pass that report name to the other <code>system_report</code> commands as well. The <code>rpttype</code> input indicates that we want to create a PowerPoint report. Default document templates will be used, but custom templates can be used as described below.</p>
</div>
<div id="content-type" class="section level3">
<h3 class="hasAnchor">
<a href="#content-type" class="anchor"></a>Content type</h3>
<p>With the report created we can begin adding slides. There are several diffent slide formats with different placeholders for content. Each placehodler can contian a different type of content (text, list, image file, etc). The following list provides the available content types followed by the format of the content:</p>
<ul>
<li>
<code>"text"</code> text string of information</li>
<li>
<code>"list"</code> vector of paired values (indent level and text), eg. <code>c(1, "Main Bullet", 2 "Sub Bullet")</code>
</li>
<li>
<code>"imagefile"</code> string containing path to image file</li>
<li>
<code>"ggplot"</code> ggplot object, eg. <code>p = ggplot() + ...</code>
</li>
<li>
<code>"table"</code> list containing the table content and other options with the following elements (defaults in parenthesis):
<ul>
<li>
<code>table</code> Data frame containing the tabular data</li>
<li>
<code>header</code> Boolean variable to control displaying the header (<code>TRUE</code>)</li>
<li>
<code>first_row</code> Boolean variable to indicate that the first row contains header information (<code>TRUE</code>)</li>
</ul>
</li>
<li>
<code>"flextable"</code> list containing flextable content and other options with the following elements (defaults in parenthesis):
<ul>
<li>
<code>table</code> Data frame containing the tabular data</li>
<li>
<code>header_top</code>, <code>header_middle</code>, <code>header_bottom</code> (<code>NULL</code>) a list the same names as the data frame names of the tabular data and values with the header text to show in the table</li>
<li>
<code>merge_header</code> (<code>TRUE</code>) Set to true to combine column headers with the same information</li>
<li>
<code>table_body_alignment</code>, <code>table_header_alignment</code> (“center”) Controls alignment</li>
<li>
<code>table_autofit</code> (<code>TRUE</code>) Automatically fit content, or specify the cell width and height with <code>cwidth</code> (<code>0.75</code>) and <code>cheight</code> (<code>0.25</code>)</li>
<li>
<code>table_theme</code> (<code>"theme_vanilla"</code>) Table theme</li>
</ul>
</li>
<li>
<code>"flextable_object"</code> Object created with the flextable package.</li>
</ul>
<p>For more details on the expected format of slide content see <code><a href="../reference/system_report_ph_content.html">?system_report_ph_content</a></code>.</p>
</div>
<div id="adding-slides-to-the-presentation" class="section level3">
<h3 class="hasAnchor">
<a href="#adding-slides-to-the-presentation" class="anchor"></a>Adding slides to the presentation</h3>
<p>First you may want to add a title slide to the presentation:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">cfg</span> <span class="op">=</span> <span class="fu"><a href="../reference/system_report_slide_title.html">system_report_slide_title</a></span><span class="op">(</span><span class="va">cfg</span>, 
           title     <span class="op">=</span> <span class="st">"Generating Inline Reports"</span>,
           sub_title <span class="op">=</span> <span class="st">"A Working Example"</span><span class="op">)</span></code></pre></div>
<p>Next you may want to add an overview of your analysis. The <code>content</code> slide provides one placeholder that you can fill with any of the above content types.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">cfg</span> <span class="op">=</span> <span class="fu"><a href="../reference/system_report_slide_content.html">system_report_slide_content</a></span><span class="op">(</span><span class="va">cfg</span>, 
           title     <span class="op">=</span> <span class="st">"Single text area"</span>,   
           content   <span class="op">=</span> <span class="st">"This vignette provides examples of how to add different types of slide content"</span> <span class="op">)</span></code></pre></div>
<div id="lists" class="section level4">
<h4 class="hasAnchor">
<a href="#lists" class="anchor"></a>Lists</h4>
<p>The default content type is text, but you may want to add a list. Lists are formatted as vectors with paired elements. The first element contains the indention level and the second element contains the actual text:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">lcont</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="st">"Top level item"</span>, 
          <span class="fl">2</span>, <span class="st">"This is a sub bullet"</span>,
          <span class="fl">2</span>, <span class="st">"This is another sub bullet"</span><span class="op">)</span>
<span class="va">cfg</span> <span class="op">=</span> <span class="fu"><a href="../reference/system_report_slide_content.html">system_report_slide_content</a></span><span class="op">(</span><span class="va">cfg</span>, 
           title        <span class="op">=</span> <span class="st">"Lists are pretty straight forward"</span>,      
           content_type <span class="op">=</span> <span class="st">"list"</span>,
           content      <span class="op">=</span> <span class="va">lcont</span><span class="op">)</span></code></pre></div>
</div>
<div id="figures" class="section level4">
<h4 class="hasAnchor">
<a href="#figures" class="anchor"></a>Figures</h4>
<p>If you are running simulations you may want to put <code>ggplot</code> figures directly into a report. Consider simulating a single dose in the <code>mab_pk</code> system:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">parameters</span> <span class="op">=</span> <span class="fu"><a href="../reference/system_fetch_parameters.html">system_fetch_parameters</a></span><span class="op">(</span><span class="va">cfg</span><span class="op">)</span>
<span class="va">cfg</span> <span class="op">=</span> <span class="fu"><a href="../reference/system_zero_inputs.html">system_zero_inputs</a></span><span class="op">(</span><span class="va">cfg</span><span class="op">)</span>
<span class="va">cfg</span> <span class="op">=</span> <span class="fu"><a href="../reference/system_set_bolus.html">system_set_bolus</a></span><span class="op">(</span><span class="va">cfg</span>, state <span class="op">=</span> <span class="st">"At"</span>,
                           times  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>  <span class="fl">0.0</span><span class="op">)</span>,
                           values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">400.0</span><span class="op">)</span><span class="op">)</span>

<span class="va">cfg</span><span class="op">=</span><span class="fu"><a href="../reference/system_set_option.html">system_set_option</a></span><span class="op">(</span><span class="va">cfg</span>, group  <span class="op">=</span> <span class="st">"simulation"</span>,
                           option <span class="op">=</span> <span class="st">"output_times"</span>,
                           value  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">60</span>,<span class="fl">.1</span><span class="op">)</span><span class="op">)</span>

<span class="va">som</span> <span class="op">=</span> <span class="fu"><a href="../reference/run_simulation_ubiquity.html">run_simulation_ubiquity</a></span><span class="op">(</span><span class="va">parameters</span>, <span class="va">cfg</span><span class="op">)</span></code></pre></div>
<p>Then we can plot the response in <code>ggplot</code>:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">myfig</span> <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> 
        <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span>data<span class="op">=</span><span class="va">som</span><span class="op">$</span><span class="va">simout</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">ts.days</span>,   y<span class="op">=</span><span class="va">C_ng_ml</span><span class="op">)</span>, color<span class="op">=</span><span class="st">"red"</span><span class="op">)</span>  <span class="op">+</span>
        <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">xlab</a></span><span class="op">(</span><span class="st">"Time (days)"</span><span class="op">)</span><span class="op">+</span>
        <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ylab</a></span><span class="op">(</span><span class="st">"C (ng/ml) (units)"</span><span class="op">)</span>
<span class="va">myfig</span> <span class="op">=</span> <span class="fu"><a href="../reference/gg_log10_yaxis.html">gg_log10_yaxis</a></span><span class="op">(</span><span class="va">myfig</span>, ylim_min<span class="op">=</span><span class="fl">1e3</span>, ylim_max<span class="op">=</span><span class="fl">1e5</span><span class="op">)</span>
<span class="va">myfig</span> <span class="op">=</span> <span class="fu"><a href="../reference/prepare_figure.html">prepare_figure</a></span><span class="op">(</span><span class="st">"present"</span>, <span class="va">myfig</span><span class="op">)</span></code></pre></div>
<p>Then that figure can be added to a slide:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">cfg</span> <span class="op">=</span> <span class="fu"><a href="../reference/system_report_slide_content.html">system_report_slide_content</a></span><span class="op">(</span><span class="va">cfg</span>, 
           title        <span class="op">=</span> <span class="st">"ggplot objects can be inserted directly"</span>, 
           content_type <span class="op">=</span> <span class="st">"ggplot"</span>,
           content      <span class="op">=</span> <span class="va">myfig</span><span class="op">)</span></code></pre></div>
<p>You can also pull image content from files as well using the <code>imagefile</code> content type.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">cfg</span> <span class="op">=</span> <span class="fu"><a href="../reference/system_report_slide_content.html">system_report_slide_content</a></span><span class="op">(</span><span class="va">cfg</span>, 
           title        <span class="op">=</span> <span class="st">"Images can be inserted from files"</span>, 
           sub_title    <span class="op">=</span> <span class="st">"But the image should have the same aspect ratio as the placeholder"</span>, 
           content_type <span class="op">=</span> <span class="st">"imagefile"</span>,
           content      <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span><span class="op">(</span><span class="st">"ubinc"</span>, <span class="st">"images"</span>, <span class="st">"report_image.png"</span>, package<span class="op">=</span><span class="st">"ubiquity"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p>The benefit of using <code>ggplot</code> is that it will automatically size the image to the dimensions of the placeholder. To use an image file the image file needs to have the same aspect ratio as the placeholder you want to put it in.</p>
</div>
<div id="tables" class="section level4">
<h4 class="hasAnchor">
<a href="#tables" class="anchor"></a>Tables</h4>
<p>Tabular data can be include too. The simplest method is to use the <code>table</code> content type and supply a list with an element named <code>table</code> containing a data frame with the tabular information you want to display:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">tcont</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="op">)</span>
<span class="va">tcont</span><span class="op">$</span><span class="va">table</span> <span class="op">=</span> <span class="va">parameters</span>
<span class="va">cfg</span> <span class="op">=</span> <span class="fu"><a href="../reference/system_report_slide_content.html">system_report_slide_content</a></span><span class="op">(</span><span class="va">cfg</span>, 
           title        <span class="op">=</span> <span class="st">"Simple Tables"</span>, 
           content_type <span class="op">=</span> <span class="st">"table"</span>,    
           content      <span class="op">=</span> <span class="va">tcont</span><span class="op">)</span></code></pre></div>
<p>This may not be the most attractive way to display tabular information, and for smaller tables it may be a bit poorly formatted. As an alternative the <code>flextable</code> package can be used by specifying that content type:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">tcont</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="op">)</span>
<span class="va">tcont</span><span class="op">$</span><span class="va">table</span> <span class="op">=</span> <span class="va">parameters</span>
<span class="va">cfg</span> <span class="op">=</span> <span class="fu"><a href="../reference/system_report_slide_content.html">system_report_slide_content</a></span><span class="op">(</span><span class="va">cfg</span>, 
           title        <span class="op">=</span> <span class="st">"Flextables"</span>, 
           content_type <span class="op">=</span> <span class="st">"flextable"</span>,    
           content      <span class="op">=</span> <span class="va">tcont</span><span class="op">)</span></code></pre></div>
<p>To provide a little more formatting, two column slides are provided. The <code>content_type</code> argument indicates the type of text that can be included. It should be either <code>"list"</code> or <code>"text"</code>.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">cfg</span> <span class="op">=</span> <span class="fu"><a href="../reference/system_report_slide_two_col.html">system_report_slide_two_col</a></span><span class="op">(</span><span class="va">cfg</span>,
        title                  <span class="op">=</span> <span class="st">"Two columns of plain text"</span>,      
        sub_title              <span class="op">=</span> <span class="st">"Subtitle"</span>, 
        content_type           <span class="op">=</span> <span class="st">"text"</span>, 
        left_content           <span class="op">=</span> <span class="st">"Left Side"</span>,
        right_content          <span class="op">=</span> <span class="st">"Right Side"</span><span class="op">)</span>

<span class="va">cfg</span> <span class="op">=</span> <span class="fu"><a href="../reference/system_report_slide_two_col.html">system_report_slide_two_col</a></span><span class="op">(</span><span class="va">cfg</span>,
       title                  <span class="op">=</span> <span class="st">"Two Col Text w/Headers"</span>,      
       sub_title              <span class="op">=</span> <span class="st">"Two columns of text with headers"</span>,
       content_type           <span class="op">=</span> <span class="st">"list"</span>, 
       right_content          <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="st">"Right Text"</span><span class="op">)</span>,
       left_content_type      <span class="op">=</span> <span class="st">"list"</span>,
       left_content           <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="st">"Left Text"</span><span class="op">)</span>,
       right_content_type     <span class="op">=</span> <span class="st">"list"</span><span class="op">)</span></code></pre></div>
<p>The main content type can be overwritten if the left or right content is to contain a table or figure it can be overwritten.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">cfg</span> <span class="op">=</span> <span class="fu"><a href="../reference/system_report_slide_two_col.html">system_report_slide_two_col</a></span><span class="op">(</span><span class="va">cfg</span>,
       title                  <span class="op">=</span> <span class="st">"Two columns of lists"</span>,      
       sub_title              <span class="op">=</span> <span class="cn">NULL</span>, 
       content_type           <span class="op">=</span> <span class="st">"list"</span>, 
       left_content           <span class="op">=</span> <span class="va">lcont</span>,
       right_content_type     <span class="op">=</span> <span class="st">"flextable"</span>,
       right_content          <span class="op">=</span> <span class="va">tcont</span><span class="op">)</span></code></pre></div>
<p>You can specify column headers if you like:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">cfg</span> <span class="op">=</span> <span class="fu"><a href="../reference/system_report_slide_two_col.html">system_report_slide_two_col</a></span><span class="op">(</span><span class="va">cfg</span>,
       title                  <span class="op">=</span> <span class="st">"Two Col Text w/Headers"</span>,      
       sub_title              <span class="op">=</span> <span class="st">"Two columns of text with headers"</span>,
       content_type           <span class="op">=</span> <span class="st">"text"</span>, 
       right_content          <span class="op">=</span> <span class="st">"Right Text"</span>,
       left_content_type      <span class="op">=</span> <span class="st">"text"</span>,
       left_content           <span class="op">=</span> <span class="st">"Left Text"</span>,
       left_content_header    <span class="op">=</span> <span class="st">"Left Header"</span>,
       right_content_header   <span class="op">=</span> <span class="st">"Right Header"</span><span class="op">)</span>

<span class="va">cfg</span> <span class="op">=</span> <span class="fu"><a href="../reference/system_report_slide_two_col.html">system_report_slide_two_col</a></span><span class="op">(</span><span class="va">cfg</span>,
       title                  <span class="op">=</span> <span class="st">"Two Col Text w/Headers"</span>,      
       sub_title              <span class="op">=</span> <span class="st">"Two columns of text with headers"</span>,
       content_type           <span class="op">=</span> <span class="st">"list"</span>, 
       right_content          <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="st">"Right Text"</span><span class="op">)</span>,
       left_content_type      <span class="op">=</span> <span class="st">"list"</span>,
       left_content           <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="st">"Left Text"</span><span class="op">)</span>,
       left_content_header    <span class="op">=</span> <span class="st">"Left Header"</span>,
       right_content_type     <span class="op">=</span> <span class="st">"list"</span>,
       right_content_header   <span class="op">=</span> <span class="st">"Right Header"</span><span class="op">)</span></code></pre></div>
<p>Headers can be can be <code>text</code>, <code>imagefile</code>, <code>ggplot</code>, <code>table</code> or <code>flextable</code>.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">cfg</span> <span class="op">=</span> <span class="fu"><a href="../reference/system_report_slide_two_col.html">system_report_slide_two_col</a></span><span class="op">(</span><span class="va">cfg</span>,
       title                  <span class="op">=</span> <span class="st">"ggplot vs imagefile"</span>,      
       sub_title              <span class="op">=</span> <span class="cn">NULL</span>, 
       content_type           <span class="op">=</span> <span class="st">"list"</span>, 
       left_content_header    <span class="op">=</span> <span class="st">"Image file"</span>,
       left_content_type      <span class="op">=</span> <span class="st">'imagefile'</span>,
       left_content           <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span><span class="op">(</span><span class="st">"ubinc"</span>, <span class="st">"images"</span>, <span class="st">"report_image.png"</span>, package<span class="op">=</span><span class="st">"ubiquity"</span><span class="op">)</span>,
       right_content_header   <span class="op">=</span> <span class="st">"ggplot object"</span>,
       right_content_type     <span class="op">=</span> <span class="st">"ggplot"</span>,
       right_content          <span class="op">=</span> <span class="va">myfig</span><span class="op">)</span></code></pre></div>
<p>The <code>flextable</code> content type is intended to provide a quick way to turn a data frame into a flextable, but if you want to create more complex tables you can use the <code>flextable_object</code> content type. Consider the two data frames containing the data and header information:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">data</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>property <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"mean"</span>,   <span class="st">"variance"</span><span class="op">)</span>,
                  Cmax     <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>,         <span class="fl">0.1</span><span class="op">)</span>,
                  AUCinf   <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">22</span>,       <span class="fl">0.21</span><span class="op">)</span>,
                  AUClast  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">22</span>,       <span class="fl">0.21</span><span class="op">)</span><span class="op">)</span>

<span class="va">header</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>property <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">""</span>,              <span class="st">""</span><span class="op">)</span>,
              Cmax     <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Cmax"</span>,          <span class="st">"ng/ml"</span><span class="op">)</span>,
              AUCinf   <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"AUCinf"</span>,        <span class="st">"mL/hr"</span><span class="op">)</span>,
              AUClast  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"AUClast"</span>,       <span class="st">"mL/hr"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p>Next we create the flextable object:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://magrittr.tidyverse.org">magrittr</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://davidgohel.github.io/flextable/">flextable</a></span><span class="op">)</span>
<span class="va">ft</span> <span class="op">=</span> <span class="fu">flextable</span><span class="fu">::</span><span class="fu"><a href="https://davidgohel.github.io/flextable/reference/flextable.html">flextable</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span>                     <span class="op">%&gt;%</span> 
     <span class="fu">flextable</span><span class="fu">::</span><span class="fu"><a href="https://davidgohel.github.io/flextable/reference/delete_part.html">delete_part</a></span><span class="op">(</span>part <span class="op">=</span> <span class="st">"header"</span><span class="op">)</span>        <span class="op">%&gt;%</span>
     <span class="fu">flextable</span><span class="fu">::</span><span class="fu"><a href="https://davidgohel.github.io/flextable/reference/add_header.html">add_header</a></span><span class="op">(</span>values <span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">as.list</a></span><span class="op">(</span><span class="va">header</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
     <span class="fu">flextable</span><span class="fu">::</span><span class="fu"><a href="https://davidgohel.github.io/flextable/reference/theme_zebra.html">theme_zebra</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p>And then we can use that directly as content:</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">cfg</span> <span class="op">=</span> <span class="fu"><a href="../reference/system_report_slide_content.html">system_report_slide_content</a></span><span class="op">(</span><span class="va">cfg</span>,
       title        <span class="op">=</span> <span class="st">"Userdefined Flextable"</span>,
       sub_title    <span class="op">=</span> <span class="st">"flextable_object"</span>,    
       content_type <span class="op">=</span> <span class="st">"flextable_object"</span>, 
       content      <span class="op">=</span> <span class="va">ft</span><span class="op">)</span></code></pre></div>
</div>
</div>
<div id="saving-slides" class="section level3">
<h3 class="hasAnchor">
<a href="#saving-slides" class="anchor"></a>Saving slides</h3>
<p>Finally, after you have added all of your sldies, you will want to save them to a file:</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/system_report_save.html">system_report_save</a></span><span class="op">(</span><span class="va">cfg</span>, output_file <span class="op">=</span> <span class="st">"report_vignette.pptx"</span><span class="op">)</span></code></pre></div>
</div>
</div>
<div id="word-reports-make_report_word-r" class="section level2">
<h2 class="hasAnchor">
<a href="#word-reports-make_report_word-r" class="anchor"></a>Word reports (<code>make_report_Word.R</code>)</h2>
<p>To generate word reports the following functions are used. The first five are the same general reporting function from above and the remaining three are specifically used for Word documents:</p>
<ul>
<li>
<code>system_report_init</code> - Initialize a new report from a template</li>
<li>
<code>system_report_view_layout</code> - Generate a PowerPoint file from a template labeling the different elements each slide layout</li>
<li>
<code>system_report_fetch</code> - Fetch the officer object for a report</li>
<li>
<code>system_report_set</code> - Set the officer object for a report</li>
<li>
<code>system_report_save</code> - Save a report to a file</li>
<li>
<code>system_report_doc_add_content</code> - Add different report elements to a document (text, figures, tables, etc)</li>
<li>
<code>system_report_doc_format_section</code> - Change section formatting (e.g. go from portrait to landscape)</li>
<li>
<code>system_report_doc_set_ph</code> - Define placeholder content mapping information</li>
</ul>
<div id="creating-a-report-1" class="section level3">
<h3 class="hasAnchor">
<a href="#creating-a-report-1" class="anchor"></a>Creating a report</h3>
<p>Like with PowerPoint reports above, we begin by initializing a report. The only difference is that we are using the <code>"Word"</code> report type.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">cfg</span> <span class="op">=</span> <span class="fu"><a href="../reference/system_report_init.html">system_report_init</a></span><span class="op">(</span><span class="va">cfg</span>, rpttype<span class="op">=</span><span class="st">"Word"</span><span class="op">)</span></code></pre></div>
</div>
<div id="content-type-1" class="section level3">
<h3 class="hasAnchor">
<a href="#content-type-1" class="anchor"></a>Content type</h3>
<p>Similar to the slide functions above, content is added to Word reports using the function <code>system_report_doc_add_content</code>. When calling this function we must specify a <code>content_type</code> and corresponding <code>content</code>. The following list provides the available content types followed by a description of the format of the content.</p>
<ul>
<li>
<code>"break"</code> content is (<code>NULL</code>) and a page break will be inserted here</li>
<li>
<code>"toc"</code> generates the table of contents, and content is a list
<ul>
<li>
<code>"level"</code> number indicating the depth of the contents to display (<code>3</code>)</li>
</ul>
</li>
<li>
<code>"text"</code> content is a list containing a paragraph of text with the following elements
<ul>
<li>
<code>"text"</code> string containing the text content either a string or the output of <code>"fpar"</code> for formatted text.</li>
<li>
<code>"style"</code> string containing the style either <code>"normal"</code>, <code>"code"</code>, <code>"h1"</code>, <code>"h2"</code>, <code>"h3"</code>
</li>
<li>
<code>"format"</code> string containing the format, either <code>"text"</code> (default <code>NULL</code> assumes <code>"text"</code> format), <code>"fpar"</code> (output of <code>fpar</code> formatted text), or <code>"md"</code> (text with Markdown to be rendered internally)</li>
</ul>
</li>
<li>
<code>"imagefile"</code> content is a list containing information describing an image file with the following elements
<ul>
<li>
<code>image</code> string containing path to image file</li>
<li>
<code>caption</code> caption of the image</li>
<li>
<code>caption_format</code> string containing the format, either <code>"text"</code>, <code>"fpar"</code>, or <code>"md"</code> (default <code>NULL</code> assumes <code>"text"</code> format)</li>
<li>
<code>key</code> unique key for cross referencing e.g. “FIG_DATA” (<code>NULL</code>)</li>
<li>
<code>height</code> height of the image (<code>NULL</code>)</li>
<li>
<code>width</code> width of the image (<code>NULL</code>)</li>
</ul>
</li>
<li>
<code>"ggplot"</code> content is a list containing an image from a ggplot object, (eg. p = ggplot() + ….) with the following elements
<ul>
<li>
<code>image</code> ggplot object</li>
<li>
<code>caption</code> caption of the image</li>
<li>
<code>caption_format</code> string containing the format, either <code>"text"</code>, <code>"fpar"</code>, or <code>"md"</code> (default <code>NULL</code> assumes <code>"text"</code> format)</li>
<li>
<code>key</code> unique key for cross referencing e.g. “FIG_DATA” (<code>NULL</code>)</li>
<li>
<code>height</code> height of the image (<code>NULL</code>)</li>
<li>
<code>width</code> width of the image (<code>NULL</code>)</li>
</ul>
</li>
<li>
<code>"table"</code> content is a list containing the table content and other options with the following elements
<ul>
<li>
<code>table</code> data frame containing the tabular data</li>
<li>
<code>caption</code> caption of the table</li>
<li>
<code>caption_format</code> string containing the format, either <code>"text"</code>, <code>"fpar"</code>, or <code>"md"</code> (default <code>NULL</code> assumes <code>"text"</code> format)</li>
<li>
<code>key</code> unique key for cross referencing e.g. “TAB_DATA” (<code>NULL</code>)</li>
<li>
<code>header</code> Boolean variable to control displaying the header (<code>TRUE</code>)</li>
<li>
<code>first_row</code> Boolean variable to indicate that the first row contains header information (<code>TRUE</code>)</li>
</ul>
</li>
<li>
<code>"flextable"</code> content is a list containing flextable content and other options with the following elements (defaults in parenthesis):
<ul>
<li>
<code>table</code> Data frame containing the tabular data</li>
<li>
<code>caption</code> caption of the table</li>
<li>
<code>caption_format</code> string containing the format, either <code>"text"</code>, <code>"fpar"</code>, or <code>"md"</code> (default <code>NULL</code> assumes <code>"text"</code> format)</li>
<li>
<code>key</code> unique key for cross referencing e.g. “TAB_DATA” (<code>NULL</code>)</li>
<li>
<code>header_top</code>, <code>header_middle</code>, <code>header_bottom</code> (<code>NULL</code>) a list with the same names as the data frame names of the tabular data and values with the header text to show in the table</li>
<li>
<code>merge_header</code> (<code>TRUE</code>) Set to true to combine column headers with the same information</li>
<li>
<code>table_body_alignment</code>, <code>table_header_alignment</code> (“center”) Controls alignment</li>
<li>
<code>table_autofit</code> (<code>TRUE</code>) Automatically fit content, or specify the cell width and height with <code>cwidth</code> (<code>0.75</code>) and <code>cheight</code> (<code>0.25</code>)</li>
<li>
<code>table_theme</code> (<code>"theme_vanilla"</code>) Table theme</li>
</ul>
</li>
<li>
<code>"flextable_object"</code> content is a list specifying the a user defined flextable object with the following elements:
<ul>
<li>
<code>caption</code> caption of the table (<code>NULL</code>)<br>
</li>
<li>
<code>ft</code> flextable object</li>
<li>
<code>key</code> unique key for cross referencing e.g. “TAB_DATA” (<code>NULL</code>)</li>
</ul>
</li>
</ul>
<p>Text can be specified in different formats: <code>"text"</code> indicates plain text, <code>"fpar"</code> is formatted text defined by the <code>fpar</code> command from the <code>officer</code> package, and <code>"md"</code> is text formatted in markdown format (<code><a href="../reference/md_to_officer.html">?md_to_officer</a></code> for markdown details).</p>
</div>
<div id="adding-content-to-the-document" class="section level3">
<h3 class="hasAnchor">
<a href="#adding-content-to-the-document" class="anchor"></a>Adding content to the document</h3>
<p>Next we can start by adding the table of contents to the document:</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">cfg</span> <span class="op">=</span> <span class="fu"><a href="../reference/system_report_doc_add_content.html">system_report_doc_add_content</a></span><span class="op">(</span><span class="va">cfg</span>, 
  content_type  <span class="op">=</span> <span class="st">"toc"</span>,
  content       <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>level<span class="op">=</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div id="different-types-of-text" class="section level4">
<h4 class="hasAnchor">
<a href="#different-types-of-text" class="anchor"></a>Different types of text</h4>
<p>We can begin by creating a header. You can add three levels of headers using the style element in the content (<code>"h1"</code>, <code>"h2"</code>, and <code>"h3"</code>).</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">cfg</span> <span class="op">=</span> <span class="fu"><a href="../reference/system_report_doc_add_content.html">system_report_doc_add_content</a></span><span class="op">(</span><span class="va">cfg</span>, 
  content_type  <span class="op">=</span> <span class="st">"text"</span>,
  content       <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>style   <span class="op">=</span> <span class="st">"h1"</span>,
                       text    <span class="op">=</span> <span class="st">"This will insert a level 1 header"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p>You can also add text using the <code>"normal"</code> and <code>"code"</code> styles. The content contains the optional format. If you do not specify a format, it will assume you’re using plain text.</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">cfg</span> <span class="op">=</span> <span class="fu"><a href="../reference/system_report_doc_add_content.html">system_report_doc_add_content</a></span><span class="op">(</span><span class="va">cfg</span>, 
  content_type  <span class="op">=</span> <span class="st">"text"</span>,
  content       <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>style   <span class="op">=</span> <span class="st">"normal"</span>,
                       text    <span class="op">=</span> <span class="st">"This is plain text"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p>Formatted text can be created using two methods.First you can use the <code>fpar</code> command from <code>officer</code>:</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>fpartext <span class="ot">=</span> <span class="fu">fpar</span>(</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ftext</span>(<span class="st">"Formatted text can be created using the "</span>, <span class="at">prop=prop=</span>officer<span class="sc">::</span><span class="fu">fp_text</span>()),</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ftext</span>(<span class="st">"fpar "</span>, <span class="at">prop=</span>officer<span class="sc">::</span><span class="fu">fp_text</span>(<span class="at">color=</span><span class="st">"green"</span>)),</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ftext</span>(<span class="st">"command from the officer package."</span>, <span class="at">prop=prop=</span>officer<span class="sc">::</span><span class="fu">fp_text</span>()))</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>cfg <span class="ot">=</span> <span class="fu">system_report_doc_add_content</span>(cfg, </span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">content_type  =</span> <span class="st">"text"</span>,</span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">content       =</span> <span class="fu">list</span>(<span class="at">style   =</span> <span class="st">"normal"</span>,</span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>                       <span class="at">format  =</span> <span class="st">"fpar"</span>,</span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>                       <span class="at">text    =</span> fpartext))</span></code></pre></div>
<p>Lastly you can specify formatting using Markdown. This also includes options for font colors and font families. The following text demonstrates the different types of Markdown. For more information see <code><a href="../reference/md_to_officer.html">?md_to_officer</a></code>.</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">mdtext</span> <span class="op">=</span> <span class="st">"Text can be specified in markdown format as well. You can specify
*bold text*, **italicized text**, ^superscripts^ and ~subscripts~. These can
be combined as well *H*~*2*~*0*.

You can change colors to  &lt;color:red&gt;red&lt;/color&gt;, &lt;color:blue&gt;blue&lt;/color&gt;, etc and
change the &lt;shade:#33ff33&gt;shading&lt;/shade&gt;. Again these can be combined
&lt;shade:orange&gt;&lt;color:green&gt;both color and shading&lt;/color&gt;&lt;/shade&gt;. You can also
change the font to things like &lt;ff:symbol&gt;*symbol*&lt;/ff&gt;."</span>

<span class="va">cfg</span> <span class="op">=</span> <span class="fu"><a href="../reference/system_report_doc_add_content.html">system_report_doc_add_content</a></span><span class="op">(</span><span class="va">cfg</span>, 
  content_type  <span class="op">=</span> <span class="st">"text"</span>,
  content       <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>style  <span class="op">=</span> <span class="st">"normal"</span>,
                       format <span class="op">=</span> <span class="st">"md"</span>,
                       text   <span class="op">=</span> <span class="va">mdtext</span><span class="op">)</span><span class="op">)</span></code></pre></div>
</div>
<div id="including-figures" class="section level4">
<h4 class="hasAnchor">
<a href="#including-figures" class="anchor"></a>Including figures</h4>
<p>First we create an image (ggplot object and file):</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">p</span> <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotate.html">annotate</a></span><span class="op">(</span><span class="st">"text"</span>, x<span class="op">=</span><span class="fl">0</span>, y<span class="op">=</span><span class="fl">0</span>, label <span class="op">=</span> <span class="st">"picture example"</span><span class="op">)</span>
<span class="va">imagefile</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html">tempfile</a></span><span class="op">(</span>pattern<span class="op">=</span><span class="st">"image"</span>, fileext<span class="op">=</span><span class="st">".png"</span><span class="op">)</span>
<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsave.html">ggsave</a></span><span class="op">(</span>filename<span class="op">=</span><span class="va">imagefile</span>, plot<span class="op">=</span><span class="va">p</span>, height<span class="op">=</span><span class="fl">5.15</span>, width<span class="op">=</span><span class="fl">9</span>, units<span class="op">=</span><span class="st">"in"</span><span class="op">)</span></code></pre></div>
<p>Figures can be added by either referencing them from a file or inserting a ggplot object directly. This is done by specifying the content type <code>"imagefile"</code> or <code>"ggplot"</code>, respectively. The content contains the filename or ggplot object and other information such as the image width, caption text, etc.</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">cfg</span> <span class="op">=</span> <span class="fu"><a href="../reference/system_report_doc_add_content.html">system_report_doc_add_content</a></span><span class="op">(</span><span class="va">cfg</span>, 
  content_type  <span class="op">=</span> <span class="st">"imagefile"</span>,
  content       <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>image   <span class="op">=</span> <span class="va">imagefile</span>,
                       caption <span class="op">=</span> <span class="st">"This is an image file"</span><span class="op">)</span><span class="op">)</span>

<span class="va">cfg</span> <span class="op">=</span> <span class="fu"><a href="../reference/system_report_doc_add_content.html">system_report_doc_add_content</a></span><span class="op">(</span><span class="va">cfg</span>, 
  content_type  <span class="op">=</span> <span class="st">"ggplot"</span>,
  content       <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>image   <span class="op">=</span> <span class="va">p</span>,
                       caption <span class="op">=</span> <span class="st">"This is a ggplot image"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
</div>
<div id="tables-1" class="section level4">
<h4 class="hasAnchor">
<a href="#tables-1" class="anchor"></a>Tables</h4>
<p>Tables can be added in two ways. The simplest is to create a table in Word using a predefined style in the template file. First a list is created to contain the table and metadata about that table. This list is then passed into <code>system_report_doc_add_content</code> with the <code>"table"</code> content type specified:</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">tc</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="op">)</span>
<span class="va">tc</span><span class="op">$</span><span class="va">table</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>Parameters <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Vp"</span>, <span class="st">"Cl"</span>, <span class="st">"Q"</span>, <span class="st">"Vt"</span><span class="op">)</span>,
                      Values     <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">4</span>,
                      Units      <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"L"</span>, <span class="st">"L/hr"</span>, <span class="st">"L/hr"</span>, <span class="st">"L"</span><span class="op">)</span> <span class="op">)</span>
<span class="va">tc</span><span class="op">$</span><span class="va">header</span>    <span class="op">=</span> <span class="cn">TRUE</span> 
<span class="va">tc</span><span class="op">$</span><span class="va">first_row</span> <span class="op">=</span> <span class="cn">TRUE</span> 
<span class="va">tc</span><span class="op">$</span><span class="va">caption</span> <span class="op">=</span> <span class="st">"This is a table"</span>

<span class="va">cfg</span> <span class="op">=</span> <span class="fu"><a href="../reference/system_report_doc_add_content.html">system_report_doc_add_content</a></span><span class="op">(</span><span class="va">cfg</span>, 
  content_type  <span class="op">=</span> <span class="st">"table"</span>,
  content       <span class="op">=</span> <span class="va">tc</span><span class="op">)</span></code></pre></div>
<p>Tables can also be created using the <code>flextable</code> package. A list can be created to contain the tabular data and other information as before. The benefit here is that you will have more control over the table formatting:</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">tcf</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="op">)</span>
<span class="va">tcf</span><span class="op">$</span><span class="va">caption</span> <span class="op">=</span> <span class="st">"This is a flextable"</span>
<span class="va">tcf</span><span class="op">$</span><span class="va">table</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>Parameters <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Vp"</span>, <span class="st">"Cl"</span>, <span class="st">"Q"</span>, <span class="st">"Vt"</span><span class="op">)</span>,
                       Values     <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">4</span>,
                       Units      <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"L"</span>, <span class="st">"L/hr"</span>, <span class="st">"L/hr"</span>, <span class="st">"L"</span><span class="op">)</span> <span class="op">)</span>
<span class="va">tcf</span><span class="op">$</span><span class="va">header_top</span>   <span class="op">=</span> 
     <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>Parameters     <span class="op">=</span> <span class="st">"Name"</span>, 
          Values         <span class="op">=</span> <span class="st">"Value"</span>,
          Units          <span class="op">=</span> <span class="st">"Units"</span><span class="op">)</span>

<span class="va">tcf</span><span class="op">$</span><span class="va">cwidth</span>        <span class="op">=</span> <span class="fl">0.8</span> 
<span class="va">tcf</span><span class="op">$</span><span class="va">table_autofit</span> <span class="op">=</span> <span class="cn">TRUE</span>
<span class="va">tcf</span><span class="op">$</span><span class="va">table_theme</span>   <span class="op">=</span><span class="st">'theme_zebra'</span>

<span class="va">cfg</span> <span class="op">=</span> <span class="fu"><a href="../reference/system_report_doc_add_content.html">system_report_doc_add_content</a></span><span class="op">(</span><span class="va">cfg</span>, 
  content_type  <span class="op">=</span> <span class="st">"flextable"</span>,
  content       <span class="op">=</span> <span class="va">tcf</span><span class="op">)</span></code></pre></div>
<p>Similar to the presentation components above, you can create more complex tables by using the <code>flextable_object</code> content type:</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://magrittr.tidyverse.org">magrittr</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://davidgohel.github.io/flextable/">flextable</a></span><span class="op">)</span>

<span class="va">data</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>property <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"mean"</span>,   <span class="st">"variance"</span><span class="op">)</span>,
                  Cmax     <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>,         <span class="fl">0.1</span><span class="op">)</span>,
                  AUCinf   <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">22</span>,       <span class="fl">0.21</span><span class="op">)</span>,
                  AUClast  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">22</span>,       <span class="fl">0.21</span><span class="op">)</span><span class="op">)</span>

<span class="va">header</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>property <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">""</span>,              <span class="st">""</span><span class="op">)</span>,
              Cmax     <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Cmax"</span>,          <span class="st">"ng/ml"</span><span class="op">)</span>,
              AUCinf   <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"AUCinf"</span>,        <span class="st">"mL/hr"</span><span class="op">)</span>,
              AUClast  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"AUClast"</span>,       <span class="st">"mL/hr"</span><span class="op">)</span><span class="op">)</span>

<span class="co"># This creates a flextable object:</span>
<span class="va">ft</span> <span class="op">=</span> <span class="fu">flextable</span><span class="fu">::</span><span class="fu"><a href="https://davidgohel.github.io/flextable/reference/flextable.html">flextable</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span>                     <span class="op">%&gt;%</span> 
     <span class="fu">flextable</span><span class="fu">::</span><span class="fu"><a href="https://davidgohel.github.io/flextable/reference/delete_part.html">delete_part</a></span><span class="op">(</span>part <span class="op">=</span> <span class="st">"header"</span><span class="op">)</span>        <span class="op">%&gt;%</span>
     <span class="fu">flextable</span><span class="fu">::</span><span class="fu"><a href="https://davidgohel.github.io/flextable/reference/add_header.html">add_header</a></span><span class="op">(</span>values <span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">as.list</a></span><span class="op">(</span><span class="va">header</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
     <span class="fu">flextable</span><span class="fu">::</span><span class="fu"><a href="https://davidgohel.github.io/flextable/reference/theme_zebra.html">theme_zebra</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p>The code above creates the following flextable:</p>
<div class="tabwid">
<style>.cl-c1266ff0{border-collapse:collapse;}.cl-c1207320{font-family:'Helvetica';font-size:11pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-c120733e{font-family:'Helvetica';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-c1208b6c{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:3pt;padding-top:3pt;padding-left:3pt;padding-right:3pt;line-height: 1;background-color:transparent;}.cl-c1208b8a{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:3pt;padding-top:3pt;padding-left:3pt;padding-right:3pt;line-height: 1;background-color:transparent;}.cl-c120c6cc{width:54pt;background-clip: padding-box;background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-c120c6ea{width:54pt;background-clip: padding-box;background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-c120c6f4{width:54pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-c120c6fe{width:54pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-c120c708{width:54pt;background-clip: padding-box;background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-c120c709{width:54pt;background-clip: padding-box;background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-c120c712{width:54pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-c120c71c{width:54pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style>
<table class="table cl-c1266ff0">
<thead>
<tr style="overflow-wrap:break-word;">
<td class="cl-c120c709"><p class="cl-c1208b6c"><span class="cl-c1207320"></span></p></td>
<td class="cl-c120c708"><p class="cl-c1208b8a"><span class="cl-c1207320">Cmax</span></p></td>
<td class="cl-c120c708"><p class="cl-c1208b8a"><span class="cl-c1207320">AUCinf</span></p></td>
<td class="cl-c120c708"><p class="cl-c1208b8a"><span class="cl-c1207320">AUClast</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-c120c71c"><p class="cl-c1208b6c"><span class="cl-c1207320"></span></p></td>
<td class="cl-c120c712"><p class="cl-c1208b8a"><span class="cl-c1207320">ng/ml</span></p></td>
<td class="cl-c120c712"><p class="cl-c1208b8a"><span class="cl-c1207320">mL/hr</span></p></td>
<td class="cl-c120c712"><p class="cl-c1208b8a"><span class="cl-c1207320">mL/hr</span></p></td>
</tr>
</thead>
<tbody>
<tr style="overflow-wrap:break-word;">
<td class="cl-c120c6ea"><p class="cl-c1208b6c"><span class="cl-c120733e">mean</span></p></td>
<td class="cl-c120c6cc"><p class="cl-c1208b8a"><span class="cl-c120733e">2.0</span></p></td>
<td class="cl-c120c6cc"><p class="cl-c1208b8a"><span class="cl-c120733e">22.00</span></p></td>
<td class="cl-c120c6cc"><p class="cl-c1208b8a"><span class="cl-c120733e">22.00</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-c120c6fe"><p class="cl-c1208b6c"><span class="cl-c120733e">variance</span></p></td>
<td class="cl-c120c6f4"><p class="cl-c1208b8a"><span class="cl-c120733e">0.1</span></p></td>
<td class="cl-c120c6f4"><p class="cl-c1208b8a"><span class="cl-c120733e">0.21</span></p></td>
<td class="cl-c120c6f4"><p class="cl-c1208b8a"><span class="cl-c120733e">0.21</span></p></td>
</tr>
</tbody>
</table>
</div>
<p>To insert this into the document we need to supply a list containing both the caption and the flextable object. The reference key field is optional:</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">tcfo</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>caption <span class="op">=</span> <span class="st">"This is a flextable object"</span>,
            key     <span class="op">=</span> <span class="st">"TAB_FTO"</span>,  
            ft      <span class="op">=</span> <span class="va">ft</span><span class="op">)</span>

<span class="va">cfg</span> <span class="op">=</span> <span class="fu"><a href="../reference/system_report_doc_add_content.html">system_report_doc_add_content</a></span><span class="op">(</span><span class="va">cfg</span>, 
  content_type  <span class="op">=</span> <span class="st">"flextable_object"</span>,
  content       <span class="op">=</span> <span class="va">tcfo</span><span class="op">)</span></code></pre></div>
<p>To use markdown in the flextable object you can use the function <code>md_to_oo</code>. The following code will format the table above:</p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">ftf</span> <span class="op">=</span> <span class="fu">flextable</span><span class="fu">::</span><span class="fu"><a href="https://davidgohel.github.io/flextable/reference/flextable.html">flextable</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span>                                                                       <span class="op">%&gt;%</span> 
      <span class="fu">flextable</span><span class="fu">::</span><span class="fu"><a href="https://davidgohel.github.io/flextable/reference/delete_part.html">delete_part</a></span><span class="op">(</span>part <span class="op">=</span> <span class="st">"header"</span><span class="op">)</span>                                                          <span class="op">%&gt;%</span>
      <span class="fu">flextable</span><span class="fu">::</span><span class="fu"><a href="https://davidgohel.github.io/flextable/reference/add_header.html">add_header</a></span><span class="op">(</span>values <span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">as.list</a></span><span class="op">(</span><span class="va">header</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
      <span class="fu">flextable</span><span class="fu">::</span><span class="fu"><a href="https://davidgohel.github.io/flextable/reference/compose.html">compose</a></span><span class="op">(</span>j    <span class="op">=</span> <span class="st">"Cmax"</span>,                                                    
                        part  <span class="op">=</span> <span class="st">"header"</span>,                                                          
                        value <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="../reference/md_to_oo.html">md_to_oo</a></span><span class="op">(</span><span class="st">"*C*~*max*~"</span><span class="op">)</span><span class="op">$</span><span class="va">oo</span>, <span class="fu"><a href="../reference/md_to_oo.html">md_to_oo</a></span><span class="op">(</span><span class="st">"*ng/ml*"</span><span class="op">)</span><span class="op">$</span><span class="va">oo</span><span class="op">)</span><span class="op">)</span>                  <span class="op">%&gt;%</span>
      <span class="fu">flextable</span><span class="fu">::</span><span class="fu"><a href="https://davidgohel.github.io/flextable/reference/compose.html">compose</a></span><span class="op">(</span>j    <span class="op">=</span> <span class="st">"AUClast"</span>,                                                    
                        part  <span class="op">=</span> <span class="st">"header"</span>,                                                          
                        value <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="../reference/md_to_oo.html">md_to_oo</a></span><span class="op">(</span><span class="st">"*AUC*~*last*~"</span><span class="op">)</span><span class="op">$</span><span class="va">oo</span>, <span class="fu"><a href="../reference/md_to_oo.html">md_to_oo</a></span><span class="op">(</span><span class="st">"*ml\U00B7hr*^*-1*^"</span><span class="op">)</span><span class="op">$</span><span class="va">oo</span><span class="op">)</span><span class="op">)</span>         <span class="op">%&gt;%</span>
      <span class="fu">flextable</span><span class="fu">::</span><span class="fu"><a href="https://davidgohel.github.io/flextable/reference/compose.html">compose</a></span><span class="op">(</span>j    <span class="op">=</span> <span class="st">"AUCinf"</span>,                                                    
                        part  <span class="op">=</span> <span class="st">"header"</span>,                                                          
                        value <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="../reference/md_to_oo.html">md_to_oo</a></span><span class="op">(</span><span class="st">"*AUC*~*inf*~"</span><span class="op">)</span><span class="op">$</span><span class="va">oo</span>, <span class="fu"><a href="../reference/md_to_oo.html">md_to_oo</a></span><span class="op">(</span><span class="st">"*ml\U00B7hr*^*-1*^"</span><span class="op">)</span><span class="op">$</span><span class="va">oo</span><span class="op">)</span><span class="op">)</span>          <span class="op">%&gt;%</span>
      <span class="fu">flextable</span><span class="fu">::</span><span class="fu"><a href="https://davidgohel.github.io/flextable/reference/compose.html">compose</a></span><span class="op">(</span>j     <span class="op">=</span> <span class="st">"property"</span>,                                                         
                         i     <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/match.html">match</a></span><span class="op">(</span><span class="st">"mean"</span>, <span class="va">data</span><span class="op">$</span><span class="va">property</span><span class="op">)</span>,                        
                         part  <span class="op">=</span> <span class="st">"body"</span>,                                                          
                         value <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="../reference/md_to_oo.html">md_to_oo</a></span><span class="op">(</span><span class="st">"Mean (&lt;ff:symbol&gt;m&lt;/ff&gt;)"</span><span class="op">)</span><span class="op">$</span><span class="va">oo</span><span class="op">)</span><span class="op">)</span>                            <span class="op">%&gt;%</span>
      <span class="fu">flextable</span><span class="fu">::</span><span class="fu"><a href="https://davidgohel.github.io/flextable/reference/compose.html">compose</a></span><span class="op">(</span>j     <span class="op">=</span> <span class="st">"property"</span>,                                                         
                         i     <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/match.html">match</a></span><span class="op">(</span><span class="st">"variance"</span>, <span class="va">data</span><span class="op">$</span><span class="va">property</span><span class="op">)</span>,                        
                         part  <span class="op">=</span> <span class="st">"body"</span>,                                                          
                         value <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="../reference/md_to_oo.html">md_to_oo</a></span><span class="op">(</span><span class="st">"Variance (&lt;ff:symbol&gt;s&lt;/ff&gt;^2^)"</span><span class="op">)</span><span class="op">$</span><span class="va">oo</span><span class="op">)</span><span class="op">)</span>                     <span class="op">%&gt;%</span>
      <span class="fu">flextable</span><span class="fu">::</span><span class="fu"><a href="https://davidgohel.github.io/flextable/reference/autofit.html">autofit</a></span><span class="op">(</span><span class="op">)</span>                                                                             <span class="op">%&gt;%</span>
      <span class="fu">flextable</span><span class="fu">::</span><span class="fu"><a href="https://davidgohel.github.io/flextable/reference/theme_zebra.html">theme_zebra</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p>This produces the following formatted output (note that the symbols will not be rendered correctly here but will be rendered correclty in Word):</p>
<div class="tabwid">
<style>.cl-c16de5ec{border-collapse:collapse;}.cl-c1699668{font-family:'Helvetica';font-size:11pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-c169967c{font-family:'Cambria (Body)';font-size:12pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-c1699686{font-family:'Cambria (Body)';font-size:7pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;position: relative;top:4pt;}.cl-c1699690{font-family:'Cambria (Body)';font-size:7pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;position: relative;bottom:4pt;}.cl-c169969a{font-family:'Cambria (Body)';font-size:12pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-c169969b{font-family:'symbol';font-size:12pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-c16996a4{font-family:'Cambria (Body)';font-size:7pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;position: relative;bottom:4pt;}.cl-c16996a5{font-family:'Helvetica';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-c169a266{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:3pt;padding-top:3pt;padding-left:3pt;padding-right:3pt;line-height: 1;background-color:transparent;}.cl-c169a27a{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:3pt;padding-top:3pt;padding-left:3pt;padding-right:3pt;line-height: 1;background-color:transparent;}.cl-c169c6ec{width:43pt;background-clip: padding-box;background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-c169c700{width:43pt;background-clip: padding-box;background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-c169c70a{width:41pt;background-clip: padding-box;background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-c169c714{width:84pt;background-clip: padding-box;background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-c169c715{width:43pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-c169c71e{width:43pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-c169c728{width:41pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-c169c729{width:84pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-c169c732{width:43pt;background-clip: padding-box;background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-c169c733{width:43pt;background-clip: padding-box;background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-c169c73c{width:41pt;background-clip: padding-box;background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-c169c73d{width:84pt;background-clip: padding-box;background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-c169c746{width:43pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-c169c750{width:43pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-c169c751{width:41pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-c169c75a{width:84pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style>
<table class="table cl-c16de5ec">
<thead>
<tr style="overflow-wrap:break-word;">
<td class="cl-c169c73d"><p class="cl-c169a266"><span class="cl-c1699668"></span></p></td>
<td class="cl-c169c73c"><p class="cl-c169a27a"><span class="cl-c169967c">C</span><span class="cl-c1699686">max</span></p></td>
<td class="cl-c169c732"><p class="cl-c169a27a"><span class="cl-c169967c">AUC</span><span class="cl-c1699686">inf</span></p></td>
<td class="cl-c169c733"><p class="cl-c169a27a"><span class="cl-c169967c">AUC</span><span class="cl-c1699686">last</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-c169c75a"><p class="cl-c169a266"><span class="cl-c1699668"></span></p></td>
<td class="cl-c169c751"><p class="cl-c169a27a"><span class="cl-c169967c">ng/ml</span></p></td>
<td class="cl-c169c746"><p class="cl-c169a27a"><span class="cl-c169967c">ml·hr</span><span class="cl-c1699690">-1</span></p></td>
<td class="cl-c169c750"><p class="cl-c169a27a"><span class="cl-c169967c">ml·hr</span><span class="cl-c1699690">-1</span></p></td>
</tr>
</thead>
<tbody>
<tr style="overflow-wrap:break-word;">
<td class="cl-c169c714"><p class="cl-c169a266"><span class="cl-c169969a">Mean (</span><span class="cl-c169969b">m</span><span class="cl-c169969a">)</span></p></td>
<td class="cl-c169c70a"><p class="cl-c169a27a"><span class="cl-c16996a5">2.0</span></p></td>
<td class="cl-c169c6ec"><p class="cl-c169a27a"><span class="cl-c16996a5">22.00</span></p></td>
<td class="cl-c169c700"><p class="cl-c169a27a"><span class="cl-c16996a5">22.00</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-c169c729"><p class="cl-c169a266"><span class="cl-c169969a">Variance (</span><span class="cl-c169969b">s</span><span class="cl-c16996a4">2</span><span class="cl-c169969a">)</span></p></td>
<td class="cl-c169c728"><p class="cl-c169a27a"><span class="cl-c16996a5">0.1</span></p></td>
<td class="cl-c169c715"><p class="cl-c169a27a"><span class="cl-c16996a5">0.21</span></p></td>
<td class="cl-c169c71e"><p class="cl-c169a27a"><span class="cl-c16996a5">0.21</span></p></td>
</tr>
</tbody>
</table>
</div>
<p>Which is inserted into the document in the same way.</p>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">tcfo</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>caption <span class="op">=</span> <span class="st">"This is a flextable object"</span>,
            key     <span class="op">=</span> <span class="st">"TAB_FTO_FORMATTED"</span>,
            ft      <span class="op">=</span> <span class="va">ftf</span><span class="op">)</span>
<span class="va">cfg</span> <span class="op">=</span> <span class="fu"><a href="../reference/system_report_doc_add_content.html">system_report_doc_add_content</a></span><span class="op">(</span><span class="va">cfg</span>, 
  content_type  <span class="op">=</span> <span class="st">"flextable_object"</span>,
  content       <span class="op">=</span> <span class="va">tcfo</span><span class="op">)</span></code></pre></div>
</div>
<div id="placeholders" class="section level4">
<h4 class="hasAnchor">
<a href="#placeholders" class="anchor"></a>Placeholders</h4>
<p>You can include placeholders in your documents. These can be in the template document itself or in the text you’re adding to the document. For example you can create placeholder text called: <code>===PHName===</code> in your document and it can be replaced by the desired text in the document. A placeholder is a unique string of text surrounded by <code>===</code> and <code>===</code>. If the placeholder is in your template document, it may not work correctly if you type the text into word. This is because while a string may appear to be a contiguous in Word, it may not be so in the underlying XML code. To ensure the string is contiguous <strong>you should type the placeholder text into a text editor, copy and paste it into template word</strong>. Next you can define the replacement text using <code>system_report_doc_set_ph</code>:</p>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">cfg</span> <span class="op">=</span> <span class="fu"><a href="../reference/system_report_doc_set_ph.html">system_report_doc_set_ph</a></span><span class="op">(</span><span class="va">cfg</span>, 
      ph_content  <span class="op">=</span> <span class="st">"Jill Smith"</span> ,
      ph_name     <span class="op">=</span> <span class="st">"PHName"</span>, 
      ph_location <span class="op">=</span> <span class="st">"header"</span><span class="op">)</span></code></pre></div>
<p>The <code>ph_location</code> can be either <code>"header"</code>, <code>"footer"</code>, or <code>"body"</code>. Note that to avoid conflicts with markdown formatting the <code>ph_name</code> should only contain letters and numbers.</p>
</div>
<div id="page-orientation-and-columns" class="section level4">
<h4 class="hasAnchor">
<a href="#page-orientation-and-columns" class="anchor"></a>Page orientation and columns</h4>
<p>To alter the orientation of the page (portrait vs. landscape) or the number of columns you would use <code>system_report_doc_format_section</code>. When this function is called it applies to all of the added content since the last time this function was called. For example to switch to landscape for a figure we must end the current section:</p>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">cfg</span> <span class="op">=</span> <span class="fu"><a href="../reference/system_report_doc_format_section.html">system_report_doc_format_section</a></span><span class="op">(</span><span class="va">cfg</span>, section_type<span class="op">=</span><span class="st">"continuous"</span><span class="op">)</span></code></pre></div>
<p>Then we can add our figure</p>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">p</span> <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotate.html">annotate</a></span><span class="op">(</span><span class="st">"text"</span>, x<span class="op">=</span><span class="fl">0</span>, y<span class="op">=</span><span class="fl">0</span>, label <span class="op">=</span> <span class="st">"picture example"</span><span class="op">)</span>

<span class="va">cfg</span> <span class="op">=</span> <span class="fu"><a href="../reference/system_report_doc_add_content.html">system_report_doc_add_content</a></span><span class="op">(</span><span class="va">cfg</span>, 
  content_type  <span class="op">=</span> <span class="st">"ggplot"</span>,
  content       <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>image   <span class="op">=</span> <span class="va">p</span>,
                       height  <span class="op">=</span> <span class="fl">2.5</span>,
                       width   <span class="op">=</span> <span class="fl">9</span>,
                       caption <span class="op">=</span> <span class="st">"This is a landscape figure"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p>Next we can apply the apply the landscape orientation to the figure.</p>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">cfg</span> <span class="op">=</span> <span class="fu"><a href="../reference/system_report_doc_format_section.html">system_report_doc_format_section</a></span><span class="op">(</span><span class="va">cfg</span>, section_type<span class="op">=</span><span class="st">"landscape"</span>, h<span class="op">=</span><span class="fl">8</span>, w<span class="op">=</span><span class="fl">10</span><span class="op">)</span></code></pre></div>
<p>The following section types are available. <code>"columns"</code>, <code>"continuous"</code>, <code>"landscape"</code>, <code>"portrait"</code>, <code>"columns"</code>, or <code>"columns_landscape"</code>.</p>
<p>Finally, after you have added all of content to your Word report, you will want to save it to a file.</p>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/system_report_save.html">system_report_save</a></span><span class="op">(</span><span class="va">cfg</span>, output_file <span class="op">=</span> <span class="st">"report_vignette.docx"</span><span class="op">)</span></code></pre></div>
</div>
</div>
</div>
<div id="using-custom-organizational-templates" class="section level2">
<h2 class="hasAnchor">
<a href="#using-custom-organizational-templates" class="anchor"></a>Using custom organizational templates</h2>
<p>To use a custom template for your organization you need to do the following:</p>
<ol style="list-style-type: decimal">
<li>Create a template with the appropriate slide masters (PowerPoint) or styles (Word)</li>
<li>Generate a layout file with mapping information for your template</li>
<li>Customize the functions in the organizational template script</li>
<li>Initialize a report indicating that you want to use this new template and add elements to the report</li>
</ol>
<div id="creating-a-powerpoint-template-for-your-organization" class="section level4">
<h4 class="hasAnchor">
<a href="#creating-a-powerpoint-template-for-your-organization" class="anchor"></a>Creating a PowerPoint template for your organization</h4>
<p>Using your organizational template create slide masters below with the content elements to the right. The title element of the <code>title_slide</code> and <code>section_slide</code> should be of the type <code>ctrTitle</code>. For the rest of the slides the title elements should be of the type <code>title</code>, and the other elements should simply be of type <code>body</code>. The format of the body elements should be plain text unless identified parenthetically below.</p>
<table class="table">
<colgroup>
<col width="24%">
<col width="75%">
</colgroup>
<thead><tr class="header">
<th align="left">Master layout name</th>
<th align="left">Content elements</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">title_slide</td>
<td align="left">title, subtitle</td>
</tr>
<tr class="even">
<td align="left">section_slide</td>
<td align="left">title, subtitle</td>
</tr>
<tr class="odd">
<td align="left">content_text</td>
<td align="left">title, subtitle, main content</td>
</tr>
<tr class="even">
<td align="left">content_list</td>
<td align="left">title, subtitle, main content (list)</td>
</tr>
<tr class="odd">
<td align="left">two_content_list</td>
<td align="left">title, subtitle, left, right, left body (list), right body (list)</td>
</tr>
<tr class="even">
<td align="left">two_content_text</td>
<td align="left">title, subtitle, left, right, left body, right body</td>
</tr>
<tr class="odd">
<td align="left">two_content_header_list</td>
<td align="left">title, subtitle, left header, right header, left body (list), right body (list)</td>
</tr>
<tr class="even">
<td align="left">two_content_header_text</td>
<td align="left">title, subtitle, left header, right header, left body, right body</td>
</tr>
<tr class="odd">
<td align="left">title_only</td>
<td align="left">title</td>
</tr>
</tbody>
</table>
</div>
<div id="creating-a-word-template-for-your-organization" class="section level4">
<h4 class="hasAnchor">
<a href="#creating-a-word-template-for-your-organization" class="anchor"></a>Creating a Word template for your organization</h4>
<p>In your Word organizational template you will need to create a Word template file with the following styles:</p>
<ul>
<li>Normal - Normal text in the body of your document</li>
<li>Code - Text with a fixed-width font (such as courier)</li>
<li>TOC - Format of table of contents</li>
<li>Heading_1 - Level 1 heading</li>
<li>Heading_2 - Level 2 heading</li>
<li>Heading_3 - Level 3 heading</li>
<li>Table - General/plain table format</li>
<li>Table_Caption - Format of captions for tables</li>
<li>Figure_Caption- Format of captions for figures</li>
</ul>
</div>
<div id="creating-the-layout-file-for-the-powerpoint-template" class="section level4">
<h4 class="hasAnchor">
<a href="#creating-the-layout-file-for-the-powerpoint-template" class="anchor"></a>Creating the layout file for the PowerPoint template</h4>
<p>Each element in a master is identified with an index number (<code>index</code>) and placeholder label (<code>ph_label</code>). These values are asigned as the master slide is built, so it can be difficult to find this information through PowerPoint. If you named your template <code>mytemplate.pptx</code>, then you can have ubiquity produce a slide deck with the masters annotated so you can identify these values:</p>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">cfg</span> <span class="op">=</span> <span class="fu"><a href="../reference/build_system.html">build_system</a></span><span class="op">(</span><span class="op">)</span>
<span class="va">cfg</span> <span class="op">=</span> <span class="fu"><a href="../reference/system_report_init.html">system_report_init</a></span><span class="op">(</span><span class="va">cfg</span>, template<span class="op">=</span><span class="st">"mytemplate.pptx"</span><span class="op">)</span>
<span class="va">cfg</span> <span class="op">=</span> <span class="fu"><a href="../reference/system_report_view_layout.html">system_report_view_layout</a></span><span class="op">(</span><span class="va">cfg</span><span class="op">)</span></code></pre></div>
<p>This should create a file called <code>layout.pptx</code> that has the <code>layout</code> name of each slide master in the title. Both the <code>ph_label</code> and <code>index</code> of each element will be identified. These slides should look something like:</p>
<div class="figure">
<img src="../../../../../Google%20Drive/Ubiquity/github/ubiquity/vignettes/report_template_layout.png" style="width:100.0%" alt=""><p class="caption">Master slide layouts</p>
</div>
</div>
<div id="creating-the-layout-file-for-the-word-template" class="section level4">
<h4 class="hasAnchor">
<a href="#creating-the-layout-file-for-the-word-template" class="anchor"></a>Creating the layout file for the Word template</h4>
<p>After you create your Word template you can create a layout file for it. If you named your template <code>mytemplate.docx</code>, then you can create the layout file using the following:</p>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">cfg</span> <span class="op">=</span> <span class="fu"><a href="../reference/build_system.html">build_system</a></span><span class="op">(</span><span class="op">)</span>
<span class="va">cfg</span> <span class="op">=</span> <span class="fu"><a href="../reference/system_report_init.html">system_report_init</a></span><span class="op">(</span><span class="va">cfg</span>, template<span class="op">=</span><span class="st">"mytemplate.docx"</span><span class="op">)</span>
<span class="va">cfg</span> <span class="op">=</span> <span class="fu"><a href="../reference/system_report_view_layout.html">system_report_view_layout</a></span><span class="op">(</span><span class="va">cfg</span><span class="op">)</span></code></pre></div>
<p>This should create a file called <code>layout.docx</code> that has an example of each style in the template. It will have the names of the styles as well that will be used to define mapping information in the organizational slide.</p>
</div>
<div id="mapping-your-layout-to-ubiquity-functions" class="section level4">
<h4 class="hasAnchor">
<a href="#mapping-your-layout-to-ubiquity-functions" class="anchor"></a>Mapping your layout to ubiquity functions</h4>
<p>Next you need to map information in your document templates. This will be done with the <code>myOrg</code> template:</p>
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">tr</span> <span class="op">=</span> <span class="fu"><a href="../reference/system_fetch_template.html">system_fetch_template</a></span><span class="op">(</span><span class="va">cfg</span>, template<span class="op">=</span><span class="st">"myOrg"</span><span class="op">)</span></code></pre></div>
<p>This should create the file <code>myOrg.R</code> in the current directory. In this file has two functions defined: modify the <code>org_pptx_meta</code> contains the mapping information for PowerPoint templates and <code>org_docx_meta</code> contains the same information for Word templates. The comments in <code>myOrg.R</code> can be useful in understanding how the content should be modified.</p>
</div>
<div id="powerpoint-template-mapping" class="section level4">
<h4 class="hasAnchor">
<a href="#powerpoint-template-mapping" class="anchor"></a>PowerPoint template mapping</h4>
<p>In the <code>myOrg.R</code> file you need to edit the <code>org_pptx_meta</code> function. The list <code>meta</code> contains default mapping information. You should open the <code>layout.pptx</code> generated above and alter the values in <code>meta</code> to match the values in the layout.</p>
</div>
<div id="word-template-mapping" class="section level4">
<h4 class="hasAnchor">
<a href="#word-template-mapping" class="anchor"></a>Word template mapping</h4>
<p>Similarly, you will need to edit the <code>org_docx_meta</code> function and put the style names from your Word document into the appropriate location in the <code>meta</code> list defined in that function. You can also customize how figure and table captions are displayed. Because of how markdown is created, elements using the <code>"md"</code> format need to have their default font attributes defined. You need to do this for each of the styles above. For example the following defines the default text properties for the <code>Normal</code> style:</p>
<pre><code>meta[["md_def"]][["Normal"]] = list(
        color          = "black",
        font.size      = 12,
        bold           = FALSE,
        italic         = FALSE,
        underlined     = FALSE,
        font.family    = "Cambria (Body)",
        vertical.align = "baseline",
        shading.color  = "transparent")</code></pre>
<p>To do this open each style in Word and set the elements in the list to the values in Word.</p>
</div>
<div id="using-your-own-template" class="section level4">
<h4 class="hasAnchor">
<a href="#using-your-own-template" class="anchor"></a>Using your own template</h4>
<p>To use your own template you simply need to source the <code>myOrg.R</code> file at the top of your script. For PowerPoint templates, initialize the report using your own template (<code>mytemplate.pptx</code>) and the meta information returned from <code>org_pptx_meta</code>:</p>
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/source.html">source</a></span><span class="op">(</span><span class="st">"myOrg.R"</span><span class="op">)</span>
<span class="va">cfg</span> <span class="op">=</span> <span class="fu"><a href="../reference/system_report_init.html">system_report_init</a></span><span class="op">(</span>cfg  <span class="op">=</span> <span class="va">cfg</span>, 
            meta     <span class="op">=</span> <span class="fu">org_pptx_meta</span><span class="op">(</span><span class="op">)</span>,
            template <span class="op">=</span> <span class="st">"mytemplate.pptx"</span><span class="op">)</span></code></pre></div>
<p>For word reports you can use the word equivalents:</p>
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/source.html">source</a></span><span class="op">(</span><span class="st">"myOrg.R"</span><span class="op">)</span>
<span class="va">cfg</span> <span class="op">=</span> <span class="fu"><a href="../reference/system_report_init.html">system_report_init</a></span><span class="op">(</span>cfg  <span class="op">=</span> <span class="va">cfg</span>, 
            meta     <span class="op">=</span> <span class="fu">org_docx_meta</span><span class="op">(</span><span class="op">)</span>,
            template <span class="op">=</span> <span class="st">"mytemplate.docx"</span><span class="op">)</span></code></pre></div>
<p>Note that you do not have to specify the <code>repttype</code> because that is inferred from the <code>template</code>. Now you can use the functions outlined above to add content to these reports.</p>
</div>
</div>
<div id="integration-with-ubiquity-workflows" class="section level2">
<h2 class="hasAnchor">
<a href="#integration-with-ubiquity-workflows" class="anchor"></a>Integration with ubiquity workflows</h2>
<p>Ubiquity provides reporting functionality for the different workflows by allowing the results of those workflows to be appended to open reports.</p>
<div id="parameter-estimation" class="section level3">
<h3 class="hasAnchor">
<a href="#parameter-estimation" class="anchor"></a>Parameter estimation</h3>
<p>After performing a parameter estimation and archiving the estimation with a specified analysis name, that analysis name can be used to retrieve the results and append them to an open report using <code>system_report_estimation</code>. This function supports both PowerPoint and Word reports.</p>
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">cfg</span> <span class="op">=</span> <span class="fu"><a href="../reference/system_report_estimation.html">system_report_estimation</a></span><span class="op">(</span>cfg<span class="op">=</span><span class="va">cfg</span>, analysis_name<span class="op">=</span><span class="st">"analysis_name"</span><span class="op">)</span></code></pre></div>
</div>
<div id="non-compartmental-analysis-nca" class="section level3">
<h3 class="hasAnchor">
<a href="#non-compartmental-analysis-nca" class="anchor"></a>Non-compartmental analysis (NCA)</h3>
<p>The results of NCA can be appended to a report using the <code>system_report_nca</code> function. This function supports both PowerPoint and Word reports.</p>
<div class="sourceCode" id="cb46"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">cfg</span> <span class="op">=</span> <span class="fu"><a href="../reference/system_report_nca.html">system_report_nca</a></span><span class="op">(</span><span class="va">cfg</span>, analysis_name <span class="op">=</span> <span class="st">"default"</span><span class="op">)</span></code></pre></div>
</div>
</div>
<div id="modifying-reports-directly-with-officer" class="section level2">
<h2 class="hasAnchor">
<a href="#modifying-reports-directly-with-officer" class="anchor"></a>Modifying reports directly with <code>officer</code>
</h2>
<p>Sometimes the functions provided above are not sufficient to get what you want done. It may be more convenient to directly use the <code>officer</code> functions to add content or modify your report. If you have report initialized, you can pull that report out of the ubiquity system object using <code>system_report_fetch</code>:</p>
<div class="sourceCode" id="cb47"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">rpt</span> <span class="op">=</span> <span class="fu">system_report_fetch</span><span class="op">(</span><span class="va">cfg</span><span class="op">)</span></code></pre></div>
<p>Now <code>rpt</code> is an <code>officer</code> object. If it contains a PowerPoint presentation you can use all of the <code>officer</code> functions for PowerPoint to modify that object. If it’s a Word document you can use the Word functions from <code>officer</code> to modify/add content. Once you’re done making changes you can put the object back using <code>system_report_set</code>:</p>
<div class="sourceCode" id="cb48"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">cfg</span> <span class="op">=</span> <span class="fu"><a href="../reference/system_report_set.html">system_report_set</a></span><span class="op">(</span><span class="va">cfg</span>, rpt <span class="op">=</span> <span class="va">rpt</span><span class="op">)</span> </code></pre></div>
<p>Then you can continue using the ubiquity functions above or save the document.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by John Harrold.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
